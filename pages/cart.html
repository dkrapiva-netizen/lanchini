<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Корзина — LANCHINI</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/style.css">
</head>
<body>

  <!-- HEADER -->
  <header class="header">
    <div class="container header__inner">
      <a href="../index.html" class="header__logo">LANCH<span>INI</span></a>
      <nav class="header__nav" id="nav">
        <a href="../index.html">Главная</a>
        <a href="catalog.html">Каталог</a>
        <a href="about.html">О нас</a>
        <a href="delivery.html">Доставка</a>
        <a href="contacts.html">Контакты</a>
      </nav>
      <div class="header__actions">
        <div class="header__search">
          <input type="text" id="search-input" placeholder="Поиск...">
          <button class="header__search-btn" id="search-btn">&#128269;</button>
        </div>
        <a href="cart.html" class="header__cart" id="cart-icon">
          &#128722;
          <span class="header__cart-count" id="cart-count" style="display:none;">0</span>
        </a>
        <button class="header__burger" id="burger" aria-label="Меню">
          <span></span><span></span><span></span>
        </button>
      </div>
    </div>
  </header>

  <!-- BREADCRUMB -->
  <div class="container">
    <div class="breadcrumb">
      <a href="../index.html">Главная</a> <span>&#8250;</span> Корзина
    </div>
  </div>

  <!-- CART -->
  <section class="cart-page">
    <div class="container">
      <h1 class="cart-page__title">Корзина</h1>
      <div id="cart-content">
        <!-- Injected by JS -->
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="footer">
    <div class="container">
      <div class="footer__inner">
        <div>
          <div class="footer__brand">LANCH<span>INI</span></div>
          <p class="footer__about">Мы создаём подарочные чайные пары, которые приносят радость и украшают чаепитие.</p>
        </div>
        <div>
          <h4 class="footer__heading">Магазин</h4>
          <div class="footer__links">
            <a href="catalog.html">Каталог</a>
            <a href="about.html">О нас</a>
            <a href="delivery.html">Доставка и оплата</a>
          </div>
        </div>
        <div>
          <h4 class="footer__heading">Помощь</h4>
          <div class="footer__links">
            <a href="contacts.html">Контакты</a>
            <a href="delivery.html">Как заказать</a>
          </div>
        </div>
        <div>
          <h4 class="footer__heading">Контакты</h4>
          <div class="footer__links">
            <a href="tel:+79991234567">+7 (999) 123-45-67</a>
            <a href="mailto:hello@lanchini.ru">hello@lanchini.ru</a>
          </div>
        </div>
      </div>
      <div class="footer__bottom">&copy; 2025 LANCHINI. Все права защищены.</div>
    </div>
  </footer>

  <div class="notification" id="notification"></div>

  <script src="../js/data.js"></script>
  <script src="../js/cart.js"></script>
  <script src="../js/app.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      renderCart();
    });

    function renderCart() {
      const container = document.getElementById('cart-content');
      const items = Cart.getItems();

      if (items.length === 0) {
        container.innerHTML = `
          <div class="cart-empty">
            <div class="cart-empty__icon">&#128722;</div>
            <p class="cart-empty__text">Ваша корзина пуста</p>
            <a href="catalog.html" class="btn btn--primary">Перейти в каталог</a>
          </div>
        `;
        return;
      }

      let itemsHTML = '';
      items.forEach(item => {
        const product = products.find(p => p.id === item.id);
        if (!product) return;
        itemsHTML += `
          <div class="cart-item" data-id="${product.id}">
            <div class="cart-item__image">${product.image}</div>
            <div class="cart-item__info">
              <a href="product.html?id=${product.id}" class="cart-item__name">${product.name}</a>
              <p class="cart-item__desc">${product.desc}</p>
              <div class="quantity" style="margin-top:8px;">
                <button class="quantity__btn cart-qty-minus" data-id="${product.id}">&#8722;</button>
                <input class="quantity__value cart-qty-input" type="number" value="${item.qty}" min="1" data-id="${product.id}">
                <button class="quantity__btn cart-qty-plus" data-id="${product.id}">&#43;</button>
              </div>
            </div>
            <div style="text-align:right;">
              <div class="cart-item__price">${(product.price * item.qty).toLocaleString('ru-RU')} &#8381;</div>
              <button class="cart-item__remove" data-id="${product.id}">Удалить</button>
            </div>
          </div>
        `;
      });

      const total = Cart.getTotal();

      container.innerHTML = `
        <div class="cart-layout">
          <div class="cart-items">${itemsHTML}</div>
          <div class="cart-summary">
            <h3 class="cart-summary__title">Итого</h3>
            <div class="cart-summary__row">
              <span>Товары (${Cart.getCount()} шт.)</span>
              <span>${total.toLocaleString('ru-RU')} &#8381;</span>
            </div>
            <div class="cart-summary__row">
              <span>Доставка</span>
              <span>${total >= 5000 ? 'Бесплатно' : '490 &#8381;'}</span>
            </div>
            <div class="cart-summary__row cart-summary__row--total">
              <span>К оплате</span>
              <span>${(total >= 5000 ? total : total + 490).toLocaleString('ru-RU')} &#8381;</span>
            </div>
            <a href="checkout.html" class="btn btn--primary btn--full">Оформить заказ</a>
          </div>
        </div>
      `;

      // Event listeners for quantity changes
      container.querySelectorAll('.cart-qty-minus').forEach(btn => {
        btn.addEventListener('click', () => {
          const id = parseInt(btn.dataset.id);
          const input = container.querySelector(`.cart-qty-input[data-id="${id}"]`);
          const v = parseInt(input.value);
          if (v > 1) {
            Cart.updateQty(id, v - 1);
            renderCart();
          }
        });
      });

      container.querySelectorAll('.cart-qty-plus').forEach(btn => {
        btn.addEventListener('click', () => {
          const id = parseInt(btn.dataset.id);
          const input = container.querySelector(`.cart-qty-input[data-id="${id}"]`);
          Cart.updateQty(id, parseInt(input.value) + 1);
          renderCart();
        });
      });

      container.querySelectorAll('.cart-item__remove').forEach(btn => {
        btn.addEventListener('click', () => {
          Cart.remove(parseInt(btn.dataset.id));
          renderCart();
          showNotification('Товар удалён из корзины');
        });
      });
    }
  </script>
</body>
</html>
